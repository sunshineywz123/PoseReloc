work_dir: ${hydra:runtime.cwd}
data_dir: ${work_dir}/data
print_config: true
seed: 12345
task_name: sort_023_posereloc
exp_name: sort_023_posereloc
trainer:
  _target_: pytorch_lightning.Trainer
  gpus:
  - 0
  min_epochs: 1
  max_epochs: 20
  gradient_clip_val: 0.5
  accumulate_grad_batches: 2
  weights_summary: null
  num_sanity_val_steps: 2
model:
  _target_: src.models.spg_model.LitModelSPG
  optimizer: adam
  lr: 0.0001
  weight_decay: 0.0
  architecture: SuperGlue
  milestones:
  - 2
  - 5
  - 7
  - 10
  gamma: 0.5
  descriptor_dim: 256
  keypoints_encoder:
  - 32
  - 64
  - 128
  sinkhorn_iterations: 100
  match_threshold: 0.5
  match_type: softmax
  pos_weights: 0.5
  neg_weights: 0.5
datamodule:
  _target_: src.datamodules.spg_datamodule.SPGDataModule
  data_dirs: ${data_dir}/sfm_model
  anno_dirs: outputs_${model.match_type}/anno
  anno_file: ${work_dir}/data/cache/${task_name}/train.json
  batch_size: 1
  num_workers: 4
  pin_memory: true
callbacks:
  model_checkpoint:
    _target_: pytorch_lightning.callbacks.ModelCheckpoint
    monitor: val/loss
    save_top_k: -1
    save_last: true
    mode: min
    dirpath: ${data_dir}/models/checkpoints/${exp_name}
    filename: '{epoch}'
  lr_monitor:
    _target_: pytorch_lightning.callbacks.LearningRateMonitor
    logging_interval: step
logger:
  tensorboard:
    _target_: pytorch_lightning.loggers.TensorBoardLogger
    save_dir: ${data_dir}/logs
    name: ${exp_name}
    default_hp_metric: false
  neptune:
    tags:
    - best_model
  csv_logger:
    save_dir: .
